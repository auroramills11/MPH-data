geom_bar()
ggplot(data=selected.smart, aes(x=ASTHMANOW))+
geom_bar()
ggplot(data=selected.smart, aes(x=ASTHMA))+
geom_bar()
ggplot(data = selected.smart, aes(x= race, fill= ASTHMANOW))+
geom_bar(position = "dodge")
ggplot(data = selected.smart, aes(x= race, fill= ASTHMANOW))+
geom_bar(position = "dodge", "X axis"= 'slant' )
ggplot(data = selected.smart, aes(x= race, fill= ASTHMANOW))+
geom_bar(position = "dodge") + scale_x_discrete(labels= "slant")
ggplot(data=selected.smart, aes(x=ASTHMANOW))+
geom_bar()
ggplot(data=selected.smart, aes(x=ASTHMA))+
geom_bar()
table1(~sex + race + education + income | ASTHMANOW, data= selected.smart)
selected.smart$BMI<- car::recode(selected.smart$BMI, recodes= "1= 'Underweight'; 2='Normal'; 3:4='Overweight/Obese'; else= 'NA'")
table1(~factor(age65) + SMOKERSTATUS + BMI | ASTHMANOW, data= selected.smart)
install.packages("MatchIt")
library(MatchIt)
pvalue<- function(x, ...) {
y<- unlist(x)
g<- factor(rep(1:length(x), times=sapply(x, length)))
if (is.numeric(y)) {
p<- t.test(y~g)$p.value
} else {
p<- chisq.test(table(y,g))$p.value
}
c("", sub("<", "&lt;", format.pval(p, digits=3, eps=0.001)))
}
table1(~sex + race + education + income | ASTHMANOW,
data= selected.smart, overall =F, extra.col = list(`P-value`=pvalue))
table1(~factor(age65) + SMOKERSTATUS + BMI | ASTHMANOW,
data= selected.smart, overall =F, extra.col = list(`P-value`=pvalue))
View(pvalue)
selected.smart %>% gtsummary::tbl_summary()
library(dplyr)
library(haven)
library(feather)
library(ggplot2)
library(table1)
library(survey)
library(car)
library(gtsummary)
library(MatchIt)
#SMART DATA
smart<-read_xpt("MMSA2021_XPT.zip")
smart.variables <- dplyr::rename(smart, county= "MMSANAME",
county.weight= "_MMSAWT",
state= "STATERE1",
education = "_EDUCAG",
sex = "_SEX",
income = "_INCOMG1",
race = "_MRACE1",
age= "_AGE_G",
age65= "_AGE65YR",
BMI= "_BMI5CAT",
SMOKERSTATUS = "_SMOKER3",
FORMERSMOKER = "_RFSMOK3",
ASTHMANOW= "_CASTHM1",
ASTHMA= "_ASTHMS1") #current,former,never
#selected variables
selected.smart<- (dplyr::select(smart.variables, county, county.weight, state, education, sex, income, race, age, age65, BMI, SMOKERSTATUS, FORMERSMOKER, ASTHMANOW, ASTHMA))
#Sex
selected.smart$sex<- car::recode(selected.smart$sex, recodes = "1='Male'; 2='Female'")
#Race
selected.smart$race<- car::recode(selected.smart$race, recodes = "1= 'White'; 2= 'Black'; 3= 'AmericanIndian/AlaskanNative'; 4= 'Asian'; 5= 'NativeHawaiian/PacificIslander'; 6= 'Other'; 7= 'Multiracial'; 77:99= 'NA'")
#Asthma Current Status
selected.smart$ASTHMANOW<- car::recode(selected.smart$ASTHMANOW, recodes = "1= 'No Asthma'; 2='Asthma'; 9='NA'")
#Income <35, 35-50k, 50-100k, >100k
selected.smart$income<- car::recode(selected.smart$income, recodes= "1:3= '<$35k'; 4= '$35-50k'; 5= '$50-100k'; 6:7= '>100k'; 9= 'NA'")
#Smoker Status
selected.smart$SMOKERSTATUS<- car::recode(selected.smart$SMOKERSTATUS, recodes= "1:2='Current Smoker'; 3= 'Former Smoker'; 4= 'Never Smoker'; 9= 'NA'")
#Age 18-24yr, 25-44yr, 45-64yr, >65
selected.smart$age<- car::recode(selected.smart$age, recodes = "1='18-24'; 2:3= '25-44'; 4:5= '45-64'; 6= '>65'")
#Age for Stratification
selected.smart$age65<- car::recode(selected.smart$age65, recodes = "1= '1'; 2= '2'; 3= 'NA'")
#Education
selected.smart$education<- car::recode(selected.smart$education, recodes = "1= 'No HighSchool'; 2= 'HighSchool'; 3:4= 'Some/HigherEduca'; 9= 'NA'")
#BMI
selected.smart$BMI<- car::recode(selected.smart$BMI, recodes= "1= 'Underweight'; 2='Normal'; 3:4='Overweight/Obese'; else= 'NA'")
#Former Smoker
#Asthma
complete.smart<- tidyr::drop_na(selected.smart) #Don't run yet!
selected.smart %>% gtsummary::tbl_summary()
selected.smart %>%
dplyr::select(-c(age65,FORMERSMOKER, state, county, county.weight)) %>%
gtsummary::tbl_summary(by= ASTHMANOW) %>%
gtsummary::add_p()
ggplot(data=selected.smart, aes(x=ASTHMANOW))+
geom_bar()
ggplot(data=selected.smart, aes(x=ASTHMA))+
geom_bar()
#Gets p-Value for Table1
pvalue<- function(x, ...) {
y<- unlist(x)
g<- factor(rep(1:length(x), times=sapply(x, length)))
if (is.numeric(y)) {
p<- t.test(y~g)$p.value
} else {
p<- chisq.test(table(y,g))$p.value
}
c("", sub("<", "&lt;", format.pval(p, digits=3, eps=0.001)))
}
table1(~sex + race + education + income | ASTHMANOW,
data= selected.smart, overall =F, extra.col = list(`P-value`=pvalue))
table1(~factor(age65) + SMOKERSTATUS + BMI | ASTHMANOW,
data= selected.smart, overall =F, extra.col = list(`P-value`=pvalue))
selected.smart %>% gtsummary::tbl_summary()
selected.smart %>%
dplyr::select(-c(age65,FORMERSMOKER, state, county, county.weight)) %>%
gtsummary::tbl_summary(by= ASTHMANOW) %>%
selected.smart %>% gtsummary::tbl_summary()
selected.smart %>%
dplyr::select(-c(age65,FORMERSMOKER, state, county, county.weight)) %>%
gtsummary::tbl_summary(by= ASTHMANOW)
ggplot(data=selected.smart, aes(x=race, y=ASTHMANOW))+
geom_boxplot()
View(complete.smart)
ggplot(data=selected.smart, aes(x=income, y=ASTHMANOW))+
geom_boxplot()
ggplot(data=complete.smart, aes(x=income, y=ASTHMANOW))+
geom_boxplot()
ggplot(data=selected.smart, aes(x=ASTHMANOW))+
geom_bar()
ggplot(data=selected.smart, aes(x=ASTHMA))+
geom_bar()
#Gets p-Value for Table1
pvalue<- function(x, ...) {
y<- unlist(x)
g<- factor(rep(1:length(x), times=sapply(x, length)))
if (is.numeric(y)) {
p<- t.test(y~g)$p.value
} else {
p<- chisq.test(table(y,g))$p.value
}
c("", sub("<", "&lt;", format.pval(p, digits=3, eps=0.001)))
}
table1(~sex + race + education + income | ASTHMANOW,
data= selected.smart, overall =F, extra.col = list(`P-value`=pvalue))
#Potential confounding
table1(~factor(age65) + SMOKERSTATUS + BMI | ASTHMANOW,
data= selected.smart, overall =F, extra.col = list(`P-value`=pvalue))
ggplot(data=selected.smart, aes(x=ASTHMANOW))+
geom_bar()
ggplot(data=selected.smart, aes(x=ASTHMA))+
geom_bar()
ggplot(data=selected.smart, aes(x=race))+
geom_bar() +
theme(axis.text.x = element_text(angle = 90))
ggplot(data=selected.smart, aes(x=ASTHMANOW))+
geom_bar()
ggplot(data=selected.smart, aes(x=ASTHMA))+
geom_bar()
ggplot(data=selected.smart, aes(x=race))+
geom_bar() +
theme(axis.text.x = element_text(angle = 45))
ggplot(data=selected.smart, aes(x=ASTHMANOW))+
geom_bar()
ggplot(data=selected.smart, aes(x=ASTHMA))+
geom_bar()
ggplot(data=selected.smart, aes(x=race))+
geom_bar() +
theme(axis.text.x = element_text(angle = 90))
ggplot(data=selected.smart, aes(x=ASTHMANOW))+
geom_bar()
ggplot(data=selected.smart, aes(x=ASTHMA))+
geom_bar()
ggplot(data=selected.smart, aes(x=race, female), y= ASTHMANOW)) +
ggplot(data=selected.smart, aes(x=ASTHMANOW))+
geom_bar()
ggplot(data=selected.smart, aes(x=ASTHMA))+
geom_bar()
ggplot(data=selected.smart, aes(x=race, female), y= ASTHMANOW) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90))
ggplot(data=selected.smart, aes(x=race, sex), y= ASTHMANOW) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90))
ggplot(data=selected.smart, aes(x= interaction(race, sex), y= ASTHMANOW)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90))
library(tidyverse)
ggplot(data=selected.smart, aes(x= interaction(race, sex), y= ASTHMANOW)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90))
ggplot(data = selected.smart, aes(x= interaction(race, sex), y= ASTHMANOW)) +
geom_boxplot() +
labs(title = "Boxplot of Asthma Prevalence", x="Race by Gender", y="Asthma Status") +
theme(axis.text.x = element_text(angle = 90))
ggplot(data = selected.smart, aes(x= interaction(race, sex), y= ASTHMA)) +
geom_boxplot() +
labs(title = "Boxplot of Asthma Prevalence", x="Race by Gender", y="Asthma Status") +
theme(axis.text.x = element_text(angle = 90))
selected.smart$ASTHMANOW<- car::recode(selected.smart$ASTHMANOW, recodes = "1= '1'; 2='2'; 9='NA'")
selected.smart$ASTHMA<- car::recode(selected.smart$ASTHMA, recodes= "1= 'Asthma'; 2= 'FormerAsthma'; 3='NeverAsthma'; 9='NA'")
ggplot(data = selected.smart, aes(x= interaction(race, sex), y= ASTHMANOW)) +
geom_boxplot() +
labs(title = "Boxplot of Asthma Prevalence", x="Race by Gender", y="Asthma Status") +
theme(axis.text.x = element_text(angle = 90))
View(selected.smart)
View(selected.smart)
selected.smart$ASTHMANOW<- car::recode(selected.smart$ASTHMANOW, recodes = "1= '1'; 2='2'; 9='NA'", as.factor = F)
#SMART DATA
smart<-read_xpt("MMSA2021_XPT.zip")
smart.variables <- dplyr::rename(smart, county= "MMSANAME",
county.weight= "_MMSAWT",
state= "STATERE1",
education = "_EDUCAG",
sex = "_SEX",
income = "_INCOMG1",
race = "_MRACE1",
age= "_AGE_G",
age65= "_AGE65YR",
BMI= "_BMI5CAT",
SMOKERSTATUS = "_SMOKER3",
FORMERSMOKER = "_RFSMOK3",
ASTHMANOW= "_CASTHM1",
ASTHMA= "_ASTHMS1") #current,former,never
#selected variables
selected.smart<- (dplyr::select(smart.variables, county, county.weight, state, education, sex, income, race, age, age65, BMI, SMOKERSTATUS, FORMERSMOKER, ASTHMANOW, ASTHMA))
#Sex
selected.smart$sex<- car::recode(selected.smart$sex, recodes = "1='Male'; 2='Female'")
#Race
selected.smart$race<- car::recode(selected.smart$race, recodes = "1= 'White'; 2= 'Black'; 3= 'AmericanIndian/AlaskanNative'; 4= 'Asian'; 5= 'NativeHawaiian/PacificIslander'; 6= 'Other'; 7= 'Multiracial'; 77:99= 'NA'")
#Asthma Current Status
selected.smart$ASTHMANOW<- car::recode(selected.smart$ASTHMANOW, recodes = "1= '1'; 2='2'; 9='NA'", as.factor = F)
#Asthma
selected.smart$ASTHMA<- car::recode(selected.smart$ASTHMA, recodes= "1= 'Asthma'; 2= 'FormerAsthma'; 3='NeverAsthma'; 9='NA'")
#Income <35, 35-50k, 50-100k, >100k
selected.smart$income<- car::recode(selected.smart$income, recodes= "1:3= '<$35k'; 4= '$35-50k'; 5= '$50-100k'; 6:7= '>100k'; 9= 'NA'")
#Smoker Status
selected.smart$SMOKERSTATUS<- car::recode(selected.smart$SMOKERSTATUS, recodes= "1:2='Current Smoker'; 3= 'Former Smoker'; 4= 'Never Smoker'; 9= 'NA'")
#Age 18-24yr, 25-44yr, 45-64yr, >65
selected.smart$age<- car::recode(selected.smart$age, recodes = "1='18-24'; 2:3= '25-44'; 4:5= '45-64'; 6= '>65'")
#Age for Stratification
selected.smart$age65<- car::recode(selected.smart$age65, recodes = "1= '1'; 2= '2'; 3= 'NA'")
#Education
selected.smart$education<- car::recode(selected.smart$education, recodes = "1= 'No HighSchool'; 2= 'HighSchool'; 3:4= 'Some/HigherEduca'; 9= 'NA'")
#BMI
selected.smart$BMI<- car::recode(selected.smart$BMI, recodes= "1= 'Underweight'; 2='Normal'; 3:4='Overweight/Obese'; else= 'NA'")
#Former Smoker
#Asthma
complete.smart<- tidyr::drop_na(selected.smart) #Don't run yet!
ggplot(data = selected.smart, aes(x= interaction(race, sex), y= ASTHMANOW)) +
geom_boxplot() +
labs(title = "Boxplot of Asthma Prevalence", x="Race by Gender", y="Asthma Status") +
theme(axis.text.x = element_text(angle = 90))
ggplot(data = selected.smart, aes(x= interaction(race, sex))) +
geom_boxplot() +
labs(title = "Boxplot of Race by Gender") +
theme(axis.text.x = element_text(angle = 90))
ggplot(data = selected.smart, aes(x= race)) +
geom_boxplot() +
labs(title = "Boxplot of Race") +
theme(axis.text.x = element_text(angle = 90))
ggplot(data = selected.smart, aes(x= race)) +
geom_bar()  +
theme(axis.text.x = element_text(angle = 90))
ggplot(data = selected.smart, aes(x= race, fill= sex)) +
geom_bar()  +
theme(axis.text.x = element_text(angle = 90))
ggplot(data = selected.smart, aes(x= race, fill= sex)) +
geom_bar(position = "dodge")  +
theme(axis.text.x = element_text(angle = 90))
chisq.test(table(selected.smart$ASTHMANOW, selected.smart$race))
chisq.test(table(selected.smart$ASTHMANOW, selected.smart$race))
chisq.test(table(selected.smart$ASTHMANOW, selected.smart$SMOKERSTATUS))
chisq.test(table(selected.smart$ASTHMANOW, selected.smart$race))
chisq.test(table(selected.smart$ASTHMANOW, selected.smart$SMOKERSTATUS))
chisq.test(table(selected.smart$ASTHMANOW, selected.smart$BMI))
chisq.test(table(selected.smart$ASTHMANOW, selected.smart$race))
chisq.test(table(selected.smart$ASTHMANOW, selected.smart$SMOKERSTATUS))
chisq.test(table(selected.smart$ASTHMANOW, selected.smart$BMI))
chisq.test(table(selected.smart$ASTHMANOW, selected.smart$age65))
summary((glm(ASTHMANOW~race, data = selected.smart, family = binomial())))
summary((glm(ASTHMANOW~race, data = selected.smart)))
summary((glm(ASTHMANOW~race, data = complete.smart)))
ggplot(data=selected.smart, aes(x=ASTHMANOW))+
geom_bar()
ggplot(data=selected.smart, aes(x=ASTHMA))+
geom_bar()
ggplot(data = selected.smart, aes(x= race, fill= sex)) +
geom_bar(position = "dodge")  +
theme(axis.text.x = element_text(angle = 90))
ggplot(data = selected.smart, aes(x=county)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90))
ggplot(data=selected.smart, aes(x=ASTHMANOW))+
geom_bar()
ggplot(data=selected.smart, aes(x=ASTHMA))+
geom_bar()
ggplot(data = selected.smart, aes(x= race, fill= sex)) +
geom_bar(position = "dodge")  +
theme(axis.text.x = element_text(angle = 90))
table1(~county | ASTHMANOW,
data= selected.smart, overall =F, extra.col = list(`P-value`=pvalue))
#Gets p-Value for Table1
pvalue<- function(x, ...) {
y<- unlist(x)
g<- factor(rep(1:length(x), times=sapply(x, length)))
if (is.numeric(y)) {
p<- t.test(y~g)$p.value
} else {
p<- chisq.test(table(y,g))$p.value
}
c("", sub("<", "&lt;", format.pval(p, digits=3, eps=0.001)))
}
table1(~sex + race + education + income | ASTHMANOW,
data= selected.smart, overall =F, extra.col = list(`P-value`=pvalue))
table1(~county | ASTHMANOW,
data= selected.smart, overall =F, extra.col = list(`P-value`=pvalue))
#Potential confounding
table1(~factor(age65) + SMOKERSTATUS + BMI | ASTHMANOW,
data= selected.smart, overall =F, extra.col = list(`P-value`=pvalue))
install.packages("PARGASITE")
library(PARGASITE)
install.packages("Pargasite")
complete.smart %>% gtsummary::tbl_summary()
selected.smart %>% gtsummary::tbl_summary()
complete.smart %>% gtsummary::tbl_summary()
selected.smart %>%
dplyr::select(-c(age65,FORMERSMOKER, state, county, county.weight)) %>%
gtsummary::tbl_summary(by= ASTHMANOW)
View(complete.smart)
complete.smart<- tidyr::drop_na(selected.smart)%>%
selected.smart %>% gtsummary::tbl_summary()
#SMART DATA
smart<-read_xpt("MMSA2021_XPT.zip")
smart.variables <- dplyr::rename(smart, county= "MMSANAME",
county.weight= "_MMSAWT",
state= "STATERE1",
education = "_EDUCAG",
sex = "_SEX",
income = "_INCOMG1",
race = "_MRACE1",
age= "_AGE_G",
age65= "_AGE65YR",
BMI= "_BMI5CAT",
SMOKERSTATUS = "_SMOKER3",
FORMERSMOKER = "_RFSMOK3",
ASTHMANOW= "_CASTHM1",
ASTHMA= "_ASTHMS1") #current,former,never
#selected variables
selected.smart<- (dplyr::select(smart.variables, county, county.weight, state, education, sex, income, race, age, age65, BMI, SMOKERSTATUS, FORMERSMOKER, ASTHMANOW, ASTHMA))
#Sex
selected.smart$sex<- car::recode(selected.smart$sex, recodes = "1='Male'; 2='Female'")
#Race
selected.smart$race<- car::recode(selected.smart$race, recodes = "1= 'White'; 2= 'Black'; 3= 'AmericanIndian/AlaskanNative'; 4= 'Asian'; 5= 'NativeHawaiian/PacificIslander'; 6= 'Other'; 7= 'Multiracial'; 77:99= 'NA'")
#Asthma Current Status
selected.smart$ASTHMANOW<- car::recode(selected.smart$ASTHMANOW, recodes = "1= '1'; 2='2'; 9='NA'", as.factor = F)
#Asthma
selected.smart$ASTHMA<- car::recode(selected.smart$ASTHMA, recodes= "1= 'Asthma'; 2= 'FormerAsthma'; 3='NeverAsthma'; 9='NA'")
#Income <35, 35-50k, 50-100k, >100k
selected.smart$income<- car::recode(selected.smart$income, recodes= "1:3= '<$35k'; 4= '$35-50k'; 5= '$50-100k'; 6:7= '>100k'; 9= 'NA'")
#Smoker Status
selected.smart$SMOKERSTATUS<- car::recode(selected.smart$SMOKERSTATUS, recodes= "1:2='Current Smoker'; 3= 'Former Smoker'; 4= 'Never Smoker'; 9= 'NA'")
#Age 18-24yr, 25-44yr, 45-64yr, >65
selected.smart$age<- car::recode(selected.smart$age, recodes = "1='18-24'; 2:3= '25-44'; 4:5= '45-64'; 6= '>65'")
#Age for Stratification
selected.smart$age65<- car::recode(selected.smart$age65, recodes = "1= '1'; 2= '2'; 3= 'NA'")
#Education
selected.smart$education<- car::recode(selected.smart$education, recodes = "1= 'No HighSchool'; 2= 'HighSchool'; 3:4= 'Some/HigherEduca'; 9= 'NA'")
#BMI
selected.smart$BMI<- car::recode(selected.smart$BMI, recodes= "1= 'Underweight'; 2='Normal'; 3:4='Overweight/Obese'; else= 'NA'")
#Former Smoker
complete.smart<- tidyr::drop_na(selected.smart)%>% #Don't run yet!
complete.smart<- tidyr::drop_na(selected.smart) #Don't run yet!
complete.smart %>% gtsummary::tbl_summary()
selected.smart %>% gtsummary::tbl_summary()
selected.smart %>%
dplyr::select(-c(age65,FORMERSMOKER, state, county, county.weight)) %>%
gtsummary::tbl_summary(by= ASTHMANOW)
complete.smart<- tidyr::drop_na(smart) #Don't run yet!Why doesn't this drop all NAs???
complete.smart %>% gtsummary::tbl_summary()
complete.smart<- tidyr::drop_na(selected.smart) #Don't run yet!Why doesn't this drop all NAs???
complete.smart %>% gtsummary::tbl_summary()
m0<- glm(ASTHMANOW ~ 1, family = "binomial", data = selected.smart)
selected.smart$ASTHMANOW<- car::recode(selected.smart$ASTHMANOW, recodes = "1= '0'; 2='1'; 9='NA'", as.factor = F)
selected.smart$ASTHMANOW<-relevel(selected.smart$ASTHMANOW, ref= '0')
m0<- glm(ASTHMANOW ~ 1, family = "binomial", data = selected.smart)
tally(~ASTHMANOW | sex, margins=TRUE, data= selected.smart)
tally(~ASTHMANOW | sex, margins=FALSE, data= selected.smart)
tally(~ASTHMANOW | sex, margins=FALSE, data= selected.smart)
m0<- glm(ASTHMANOW ~ 1, data = selected.smart)
selected.smart$age65<- car::recode(selected.smart$age65, recodes = "1= '0'; 2= '1'; 3= 'NA'; else='NA'")
selected.smart$education<- car::recode(selected.smart$education, recodes = "1= 'No HighSchool'; 2= 'HighSchool'; 3:4= 'Some/HigherEduca'; 9= 'Unknown'")
#Education
selected.smart$education<- car::recode(selected.smart$education, recodes = "1= 'No HighSchool'; 2= 'HighSchool'; 3:4= 'Some/HigherEduca'; 9= 'NA'; else='NA'")
complete.smart<- tidyr::drop_na(selected.smart) #Don't run yet!Why doesn't this drop all NAs???
complete.smart %>% gtsummary::tbl_summary()
#Income <35, 35-50k, 50-100k, >100k
selected.smart$income<- car::recode(selected.smart$income, recodes= "1:3= '<$35k'; 4= '$35-50k'; 5= '$50-100k'; 6:7= '>100k'; 9= 'NA'; else='NA'")
complete.smart<- tidyr::drop_na(selected.smart) #Don't run yet!Why doesn't this drop all NAs???
complete.smart %>% gtsummary::tbl_summary()
selected.smart$race<- car::recode(selected.smart$race, recodes = "1= 'White'; 2= 'Black'; 3= 'AmericanIndian/AlaskanNative'; 4= 'Asian'; 5= 'NativeHawaiian/PacificIslander'; 6= 'Other'; 7= 'Multiracial'; 77:99= 'NA'; else='NA'")
complete.smart<- tidyr::drop_na(selected.smart) #Don't run yet!Why doesn't this drop all NAs???
complete.smart %>% gtsummary::tbl_summary()
#SMART DATA
smart<-read_xpt("MMSA2021_XPT.zip")
smart.variables <- dplyr::rename(smart, county= "MMSANAME",
county.weight= "_MMSAWT",
state= "STATERE1",
education = "_EDUCAG",
sex = "_SEX",
income = "_INCOMG1",
race = "_MRACE1",
age= "_AGE_G",
age65= "_AGE65YR",
BMI= "_BMI5CAT",
SMOKERSTATUS = "_SMOKER3",
FORMERSMOKER = "_RFSMOK3",
ASTHMANOW= "_CASTHM1",
ASTHMA= "_ASTHMS1") #current,former,never
#selected variables
selected.smart<- (dplyr::select(smart.variables, county, county.weight, state, education, sex, income, race, age, age65, BMI, SMOKERSTATUS, FORMERSMOKER, ASTHMANOW, ASTHMA))
#Sex
selected.smart$sex<- car::recode(selected.smart$sex, recodes = "1='Male'; 2='Female'")
#Race
selected.smart$race<- car::recode(selected.smart$race, recodes = "1= 'White'; 2= 'Black'; 3= 'AmericanIndian/AlaskanNative'; 4= 'Asian'; 5= 'NativeHawaiian/PacificIslander'; 6= 'Other'; 7= 'Multiracial'; 77:99= 'NA'")
#Asthma Current Status
selected.smart$ASTHMANOW<- car::recode(selected.smart$ASTHMANOW, recodes = "1= '0'; 2='1'; 9='NA'", as.factor = F)
#Asthma
selected.smart$ASTHMA<- car::recode(selected.smart$ASTHMA, recodes= "1= 'Asthma'; 2= 'FormerAsthma'; 3='NeverAsthma'; 9='NA'")
#Income <35, 35-50k, 50-100k, >100k
selected.smart$income<- car::recode(selected.smart$income, recodes= "1:3= '<$35k'; 4= '$35-50k'; 5= '$50-100k'; 6:7= '>100k'; 9= 'NA'")
#Smoker Status
selected.smart$SMOKERSTATUS<- car::recode(selected.smart$SMOKERSTATUS, recodes= "1:2='Current Smoker'; 3= 'Former Smoker'; 4= 'Never Smoker'; 9= 'NA'")
#Age 18-24yr, 25-44yr, 45-64yr, >65
selected.smart$age<- car::recode(selected.smart$age, recodes = "1='18-24'; 2:3= '25-44'; 4:5= '45-64'; 6= '>65'")
#Age for Stratification
selected.smart$age65<- car::recode(selected.smart$age65, recodes = "1= '0'; 2= '1'; 3= 'NA'")
#Education
selected.smart$education<- car::recode(selected.smart$education, recodes = "1= 'No HighSchool'; 2= 'HighSchool'; 3:4= 'Some/HigherEduca'; 9= 'NA'")
#BMI
selected.smart$BMI<- car::recode(selected.smart$BMI, recodes= "1= 'Underweight'; 2='Normal'; 3:4='Overweight/Obese'; else= 'NA'")
#Former Smoker?
selected.smart$sex<- car::recode(selected.smart$sex, recodes = "1='Male'; 2='Female'")
#Race
selected.smart$race<- car::recode(selected.smart$race, recodes = "1= 'White'; 2= 'Black'; 3= 'AmericanIndian/AlaskanNative'; 4= 'Asian'; 5= 'NativeHawaiian/PacificIslander'; 6= 'Other'; 7= 'Multiracial'; c(77:99)= NA")
selected.smart$ASTHMANOW<- car::recode(selected.smart$ASTHMANOW, recodes = "1= '0'; 2='1'; c(9)= NA")
selected.smart$ASTHMA<- car::recode(selected.smart$ASTHMA, recodes= "1= 'Asthma'; 2= 'FormerAsthma'; 3='NeverAsthma'; c(9)=NA")
selected.smart$race<- car::recode(selected.smart$race, recodes = "1= 'White'; 2= 'Black'; 3= 'AmericanIndian/AlaskanNative'; 4= 'Asian'; 5= 'NativeHawaiian/PacificIslander'; 6= 'Other'; 7= 'Multiracial'; else= NA")
selected.smart$income<- car::recode(selected.smart$income, recodes= "1:3= '<$35k'; 4= '$35-50k'; 5= '$50-100k'; 6:7= '>100k'; c(9)= NA")
#Smoker Status
selected.smart$SMOKERSTATUS<- car::recode(selected.smart$SMOKERSTATUS, recodes= "1:2='Current Smoker'; 3= 'Former Smoker'; 4= 'Never Smoker'; c(9)= NA")
#Age 18-24yr, 25-44yr, 45-64yr, >65
selected.smart$age<- car::recode(selected.smart$age, recodes = "1='18-24'; 2:3= '25-44'; 4:5= '45-64'; 6= '>65'")
#Age for Stratification
selected.smart$age65<- car::recode(selected.smart$age65, recodes = "1= '0'; 2= '1'; c(3)= NA")
#Education
selected.smart$education<- car::recode(selected.smart$education, recodes = "1= 'No HighSchool'; 2= 'HighSchool'; 3:4= 'Some/HigherEduca'; c(9)= NA")
#BMI
selected.smart$BMI<- car::recode(selected.smart$BMI, recodes= "1= 'Underweight'; 2='Normal'; 3:4='Overweight/Obese'; else= NA")
#Former Smoker?
complete.smart<- tidyr::drop_na(selected.smart) #Don't run yet!Why doesn't this drop all NAs???
complete.smart %>% gtsummary::tbl_summary()
View(selected.smart)
selected.smart$race<- car::recode(selected.smart$race, recodes = "1= 'White'; 2= 'Black'; 3= 'AmericanIndian/AlaskanNative'; 4= 'Asian'; 5= 'NativeHawaiian/PacificIslander'; 6= 'Other'; 7= 'Multiracial'; 77:99= NA")
#SMART DATA
smart<-read_xpt("MMSA2021_XPT.zip")
smart.variables <- dplyr::rename(smart, county= "MMSANAME",
county.weight= "_MMSAWT",
state= "STATERE1",
education = "_EDUCAG",
sex = "_SEX",
income = "_INCOMG1",
race = "_MRACE1",
age= "_AGE_G",
age65= "_AGE65YR",
BMI= "_BMI5CAT",
SMOKERSTATUS = "_SMOKER3",
FORMERSMOKER = "_RFSMOK3",
ASTHMANOW= "_CASTHM1",
ASTHMA= "_ASTHMS1") #current,former,never
#selected variables
selected.smart<- (dplyr::select(smart.variables, county, county.weight, state, education, sex, income, race, age, age65, BMI, SMOKERSTATUS, FORMERSMOKER, ASTHMANOW, ASTHMA))
#Sex
selected.smart$sex<- car::recode(selected.smart$sex, recodes = "1='Male'; 2='Female'")
#Race
selected.smart$race<- car::recode(selected.smart$race, recodes = "1= 'White'; 2= 'Black'; 3= 'AmericanIndian/AlaskanNative'; 4= 'Asian'; 5= 'NativeHawaiian/PacificIslander'; 6= 'Other'; 7= 'Multiracial'; 77:99= NA")
#Asthma Current Status
selected.smart$ASTHMANOW<- car::recode(selected.smart$ASTHMANOW, recodes = "1= '0'; 2='1'; 9= NA")
#Asthma
selected.smart$ASTHMA<- car::recode(selected.smart$ASTHMA, recodes= "1= 'Asthma'; 2= 'FormerAsthma'; 3='NeverAsthma'; 9=NA")
#Income <35, 35-50k, 50-100k, >100k
selected.smart$income<- car::recode(selected.smart$income, recodes= "1:3= '<$35k'; 4= '$35-50k'; 5= '$50-100k'; 6:7= '>100k';9=NA")
#Smoker Status
selected.smart$SMOKERSTATUS<- car::recode(selected.smart$SMOKERSTATUS, recodes= "1:2='Current Smoker'; 3= 'Former Smoker'; 4= 'Never Smoker';9= NA")
#Age 18-24yr, 25-44yr, 45-64yr, >65
selected.smart$age<- car::recode(selected.smart$age, recodes = "1='18-24'; 2:3= '25-44'; 4:5= '45-64'; 6= '>65'")
#Age for Stratification
selected.smart$age65<- car::recode(selected.smart$age65, recodes = "1= '0'; 2= '1'; 3= NA")
#Education
selected.smart$education<- car::recode(selected.smart$education, recodes = "1= 'No HighSchool'; 2= 'HighSchool'; 3:4= 'Some/HigherEduca'; 9= NA")
#BMI
selected.smart$BMI<- car::recode(selected.smart$BMI, recodes= "1= 'Underweight'; 2='Normal'; 3:4='Overweight/Obese'; else= NA")
#Former Smoker?
complete.smart<- tidyr::drop_na(selected.smart)
View(complete.smart)
complete.smart %>% gtsummary::tbl_summary()
tally(~ASTHMANOW | sex, margins=FALSE, data= complete.smart)
m0<- glm(ASTHMANOW ~ 1, data = selected.smart)
summary(m0)
m1<- glm(~ASTHMANOW | sex + age65, family = "binomial", data = complete.smart)
m1<- glm(~ASTHMANOW | age65, family = "binomial", data = complete.smart)
tally(~ASTHMANOW | age65, margins=FALSE, data= complete.smart)
tally(~ASTHMANOW | age65, margins=TRUE, data= complete.smart)
install.packages("mosaic")
library(mosaic)
tally(~ ASTHMANOW | age65, margins=TRUE, data= complete.smart)
m1<- glm(~ASTHMANOW | age65, family = "binomial", data = complete.smart)
