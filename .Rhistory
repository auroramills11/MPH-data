library(dplyr)
library(haven)
library(feather)
library(rmarkdown)
library(knitr)
library(ggplot2)
library(cowplot)
library(table1) #mask error
brfss<- read_xpt("LLCP2021XPT.zip")
smart21<-read_xpt("MMSA2021_XPT.zip")
#data is from 2021
smart.variables <- dplyr::rename(smart21, county= "MMSANAME",
county.weight= "_MMSAWT",
education = "_EDUCAG",
sex = "_SEX",
income = "_INCOMG1",
race = "_MRACE1",
age65 = "_AGE65YR",
age= "_AGE_G",
smoker.status = "_SMOKER3",
former.smoker = "_RFSMOK3",
asthma.status= "_ASTHMS1")
#re-named  variables
newsmart.variables<- (dplyr::select(smart.variables, county, county.weight, education, sex, income, race, age65, age, smoker.status, former.smoker, asthma.status))
#selected variables
brfss.variables<- dplyr::rename(brfss, lungcancer= CNCRTYP1)
#re-named variable
newbrfss.variables<- (dplyr::select(brfss.variables, lungcancer))
#selected variable
complete.brfss<- tidyr::drop_na(newbrfss.variables)
#dropped NAs
lungCA<- dplyr::filter(complete.brfss, lungcancer ==24)
head(lungCA)
#subset row for lung CA only
View(lungCA)
View(lungCA)
View(newsmart.variables)
View(newsmart.variables)
View(smart.variables)
View(smart.variables)
View(brfss)
View(brfss)
smart.variables <- dplyr::rename(smart21, county= "MMSANAME",
county.weight= "_MMSAWT",
education = "_EDUCAG",
sex = "_SEX",
income = "_INCOMG1",
race = "_MRACE1",
age65 = "_AGE65YR",
age= "_AGE_G",
smoker.status = "_SMOKER3",
former.smoker = "_RFSMOK3",
asthma.status= "_ASTHMS1",
state= "STATERE1")
newsmart.variables<- (dplyr::select(smart.variables, county, county.weight, education, sex, income, race, age65, age, smoker.status, former.smoker, asthma.status, state))
brfss<- dplyr::rename(brfss, lungcancer= "CNCRTYP1",
state= "_STATE")
brfss.variables<- (dplyr::select(brfss.variables, lungcancer, state))
brfss.variables<- (dplyr::select(brfss, lungcancer, state))
#selected variable
complete.brfss<- tidyr::drop_na(brfss.variables)
lungCA<- dplyr::filter(complete.brfss, lungcancer ==24)
head(lungCA)
View(lungCA)
getwd()
library(dplyr)
library(haven)
library(feather)
library(ggplot2)
library(table1)
library(survey)
library(car)
brfss<- read_xpt("LLCP2021XPT.zip")
smart<-read_xpt("MMSA2021_XPT.zip")
#data is from 2021
#SMART DATA
smart.variables <- dplyr::rename(smart, county= "MMSANAME",
county.weight= "_MMSAWT",
education = "_EDUCAG",
sex = "_SEX",
income = "_INCOMG1",
race = "_MRACE1",
age= "_AGE_G",
smoker.status = "_SMOKER3",
former.smoker = "_RFSMOK3",
asthma= "_CASTHM1",
state= "STATERE1",
code="DISPCODE")
#selected variables
selected.smart<- (dplyr::select(smart.variables, county, county.weight, education, sex, income, race, age, smoker.status, former.smoker, asthma, state, code))
#Sex
selected.smart$sex<- car::recode(selected.smart$sex, recodes = "1='0'; 2='1'")
#Income <35, 35-50k, 50-100k, >100k
selected.smart$income<- car::recode(selected.smart$income, recodes= "1:3= '0'; 4= '1'; 5= '2'; 6:7= '3'; 9= '99'")
#Race
selected.smart$race<- car::recode(selected.smart$race, recodes = "1= '0'; 2= '1'; 3= '2'; 4= '3'; 5= '4'; 6= '5'; 7= '6'; 7:9= '99'")
#Age 18-24yr, 25-44yr, 45-64yr, >65
selected.smart$age<- car::recode(selected.smart$age, recodes = "1='0'; 2:3= '1'; 4:5= '2'; 6= '3'")
#Education
selected.smart$education<- car::recode(selected.smart$education, recodes = "1= '0'; 2= '1'; 3:4= '2'; 9= '99'")
#Smoker Status
selected.smart$smoker.status<- car::recode(selected.smart$smoker.status, recodes= "1:2='2'; 3= '1'; 4= '0'; 9= '99'")
#Asthma Status
selected.smart$asthma<- car::recode(selected.smart$asthma, recodes = "1= '0'; 2='1'; 9='99'")
selected.smart<- tidyr::drop_na(selected.smart)
brfss<- dplyr::rename(brfss,
lungcancer= "CNCRTYP1",
state= "_STATE",
code="DISPCODE")
selected.brfss<- (dplyr::select(brfss, lungcancer, state, code))
selected.brfss$lungcancer<- car::recode(selected.brfss$lungcancer, recodes = "1='0'; 2='0'; 3='0'; 4='0'; 5='0'; 5='0'; 6='0'; 7='0'; 8='0'; 9='0'; 10='0'; 11='0'; 12='0'; 13='0'; 14='0'; 15='0'; 16='0'; 17='0'; 18='0'; 19='0'; 20='0'; 21='0'; 22='0'; 23='0'; 24='1'; 25='0'; 26='0'; 27='0'; 28='0'; 29='0'; 30='0'; 77:99= '99'")
selected.brfss<- tidyr::drop_na(selected.brfss)
View(smart)
brfss<- dplyr::rename(brfss,
lungcancer= "CNCRTYP1",
state= "_STATE",
educa= "_EDUCAG",
sex= "SEXVAR",
race= "_RACE",
age= "_AGE_G",
bmi= "BMI5CAT",
smoke.history= "_SMOKER3",
asthma.history= "ASTHNOW")
brfss<- read_xpt("LLCP2021XPT.zip")
brfss<- dplyr::rename(brfss,
lungcancer= "CNCRTYP1",
state= "_STATE",
educa= "_EDUCAG",
sex= "SEXVAR",
race= "_RACE",
age= "_AGE_G",
bmi= "BMI5CAT",
smoke.history= "_SMOKER3",
asthma.history= "ASTHNOW")
brfss<- dplyr::rename(brfss,
lungcancer= "CNCRTYP1",
state= "_STATE",
educa= "_EDUCAG",
sex= "SEXVAR",
race= "_RACE",
age= "_AGE_G",
bmi= "_BMI5CAT",
smoke.history= "_SMOKER3",
asthma.history= "ASTHNOW")
selected.brfss<- (dplyr::select(brfss, lungcancer, state, educa, sex, race, age, bmi, smoke.history, asthma.history))
View(selected.smart)
View(selected.brfss)
selected.brfss$lungcancer<- car::recode(selected.brfss$lungcancer, recodes = "1='0'; 2='0'; 3='0'; 4='0'; 5='0'; 5='0'; 6='0'; 7='0'; 8='0'; 9='0'; 10='0'; 11='0'; 12='0'; 13='0'; 14='0'; 15='0'; 16='0'; 17='0'; 18='0'; 19='0'; 20='0'; 21='0'; 22='0'; 23='0'; 24='1'; 25='0'; 26='0'; 27='0'; 28='0'; 29='0'; 30='0'; 77:99= '99'")
View(selected.brfss)
selected.brfss<- tidyr::drop_na(selected.brfss)
table1(~sex + race + age + bmi | lungcancer, data=selected.brfss)
table1(~lung cancer | sex, data=selected.brfss)
table1(~lungcancer | sex, data=selected.brfss)
selected.brfss$sex <-
factor(selected.brfss$sex, levels=c(1,0),
labels=c("Male",
"Female"))
table1(~sex + race + age + bmi | lungcancer, data=selected.brfss)
selected.brfss$lungcancer<- car::recode(selected.brfss$lungcancer, recodes = "1='0'; 2='0'; 3='0'; 4='0'; 5='0'; 5='0'; 6='0'; 7='0'; 8='0'; 9='0'; 10='0'; 11='0'; 12='0'; 13='0'; 14='0'; 15='0'; 16='0'; 17='0'; 18='0'; 19='0'; 20='0'; 21='0'; 22='0'; 23='0'; 24='1'; 25='0'; 26='0'; 27='0'; 28='0'; 29='0'; 30='0'; 77:99= '99'")
selected.brfss$lungcancer<- car::recode(selected.brfss$lungcancer, recodes = "1='0'; 2='0'; 3='0'; 4='0'; 5='0'; 5='0'; 6='0'; 7='0'; 8='0'; 9='0'; 10='0'; 11='0'; 12='0'; 13='0'; 14='0'; 15='0'; 16='0'; 17='0'; 18='0'; 19='0'; 20='0'; 21='0'; 22='0'; 23='0'; 24='1'; 25='0'; 26='0'; 27='0'; 28='0'; 29='0'; 30='0'; 77:99= 'NA'")
selected.brfss$sex<- car::recode(selected.brfss$sex, recodes= "1='Male'; 2='Female'", as.factor =T)
selected.brfss$sex<- relevel(selected.brfss$sex, ref= 'Male')
selected.brfss$educa<- car::recode(selected.brfss$educa, recodes= "1='NoHighSchool', 2='HighSchool', 3:4='Some/HigherEduca', 9= 'NA'", as.factor=T)
selected.brfss$educa<- car::recode(selected.brfss$educa, recodes= "1='NoHighSchool'; 2='HighSchool'; 3:4='Some/HigherEduca'; 9= 'NA'", as.factor=T)
selected.brfss$educa<-relevel(selected.brfss$educa, ref= 'Some/HigherEduca')
selected.brfss$race<- car::recode(selected.brfss$race, recodes = "1='White'; 2='Black'; 3= 'AmericanIndian/AlaskanNative'; 4='Asian'; 5='NativeHawaiian/PacificIslander'; 6='Other'; 7='Multiracial'; 8='Hispanic'; 9='NA'", as.factor = T)
selected.brfss$race<-relevel(selected.brfss$racem, ref= 'White')
selected.brfss$race<-relevel(selected.brfss$race, ref= 'White')
head(selected.brfss$age)
head(selected.brfss$bmi)
selected.brfss$bmi<- car::recode(selected.brfss$bmi, recodes = "1='Underweight'; 2='Normal'; 3='Overweight'; 4='Obese', else='NA'", as.factor = T)
selected.brfss$bmi<- car::recode(selected.brfss$bmi, recodes = "1='Underweight'; 2='Normal'; 3='Overweight'; 4='Obese'; else='NA'", as.factor = T)
selected.brfss$bmi<- relevel(selected.brfss$bmi, ref = 'Normal')
selected.brfss$smoke.history<- car::recode(selected.brfss$smoke.history, recodes = "1:2='current smoker'; 3='former smoker'; 4='never smoker'; 9='NA'", as.factor = T)
selected.brfss$smoke.history<- relevel(selected.brfss$smoke.history, ref = 'never smoker')
selected.brfss$lungcancer<- car::recode(selected.brfss$lungcancer, recodes = "1='0'; 2='0'; 3='0'; 4='0'; 5='0'; 5='0'; 6='0'; 7='0'; 8='0'; 9='0'; 10='0'; 11='0'; 12='0'; 13='0'; 14='0'; 15='0'; 16='0'; 17='0'; 18='0'; 19='0'; 20='0'; 21='0'; 22='0'; 23='0'; 24='1'; 25='0'; 26='0'; 27='0'; 28='0'; 29='0'; 30='0'; 77:99=NA")
selected.brfss$asthma.histor<- car::recode(selected.brfss$asthma.history, recodes = "1='1'; 2='0'; else=NA", as.factor = T)
selected.brfss$asthma.history<-relevel(selected.brfss$asthma.history, ref = '0')
brfss<- dplyr::rename(brfss,
lungcancer= "CNCRTYP1",
state= "_STATE",
educa= "_EDUCAG",
income= "_INCOMG1"
sex= "SEXVAR",
brfss<- dplyr::rename(brfss,
lungcancer= "CNCRTYP1",
state= "_STATE",
educa= "_EDUCAG",
income= "_INCOMG1",
sex= "SEXVAR",
race= "_RACE",
age= "_AGE_G",
bmi= "_BMI5CAT",
smoke.status= "_SMOKER3",
asthma= "ASTHNOW")
brfss<- read_xpt("LLCP2021XPT.zip")
brfss<- dplyr::rename(brfss,
lungcancer= "CNCRTYP1",
state= "_STATE",
educa= "_EDUCAG",
income= "_INCOMG1",
sex= "SEXVAR",
race= "_RACE",
age= "_AGE_G",
bmi= "_BMI5CAT",
smoke.status= "_SMOKER3",
asthma= "ASTHNOW")
selected.brfss<- (dplyr::select(brfss, lungcancer, state, educa, income, sex, race, age, bmi, smoke.status, asthma))
selected.brfss$lungcancer<- car::recode(selected.brfss$lungcancer, recodes = "1='0'; 2='0'; 3='0'; 4='0'; 5='0'; 5='0'; 6='0'; 7='0'; 8='0'; 9='0'; 10='0'; 11='0'; 12='0'; 13='0'; 14='0'; 15='0'; 16='0'; 17='0'; 18='0'; 19='0'; 20='0'; 21='0'; 22='0'; 23='0'; 24='1'; 25='0'; 26='0'; 27='0'; 28='0'; 29='0'; 30='0'; 7:9=NA")
View(selected.brfss)
selected.brfss$lungcancer<- car::recode(selected.brfss$lungcancer, recodes = "1='0'; 2='0'; 3='0'; 4='0'; 5='0'; 5='0'; 6='0'; 7='0'; 8='0'; 9='0'; 10='0'; 11='0'; 12='0'; 13='0'; 14='0'; 15='0'; 16='0'; 17='0'; 18='0'; 19='0'; 20='0'; 21='0'; 22='0'; 23='0'; 24='1'; 25='0'; 26='0'; 27='0'; 28='0'; 29='0'; 30='0'; 77:99=NA")
selected.brfss$lungcancer<- car::recode(selected.brfss$lungcancer, recodes = "1='0'; 2='0'; 3='0'; 4='0'; 5='0'; 5='0'; 6='0'; 7='0'; 8='0'; 9='0'; 10='0'; 11='0'; 12='0'; 13='0'; 14='0'; 15='0'; 16='0'; 17='0'; 18='0'; 19='0'; 20='0'; 21='0'; 22='0'; 23='0'; 24='1'; 25='0'; 26='0'; 27='0'; 28='0'; 29='0'; 30='0'; 77:99=NA")
View(selected.brfss)
selected.brfss$asthma<- car::recode(selected.brfss$asthma, recodes = "1='1'; 2='0'; else=NA", as.factor = T)
selected.brfss$smoke.status<- car::recode(selected.brfss$smoke.status, recodes = "1:2='current smoker'; 3='former smoker'; 4='never smoker'; 9='NA'", as.factor = T)
selected.brfss$smoke.status<- relevel(selected.brfss$smoke.status, ref = 'never smoker')
selected.brfss$sex<- car::recode(selected.brfss$sex, recodes= "1='Male'; 2='Female'", as.factor =T)
selected.brfss$sex<- relevel(selected.brfss$sex, ref= 'Male')
selected.brfss$educa<- car::recode(selected.brfss$educa, recodes= "1='NoHighSchool'; 2='HighSchool'; 3:4='Some/HigherEduca'; 9= 'NA'", as.factor=T)
selected.brfss$educa<-relevel(selected.brfss$educa, ref= 'Some/HigherEduca')
selected.brfss$race<- car::recode(selected.brfss$race, recodes = "1='White'; 2='Black'; 3= 'AmericanIndian/AlaskanNative'; 4='Asian'; 5='NativeHawaiian/PacificIslander'; 6='Other'; 7='Multiracial'; 8='Hispanic'; 9='NA'", as.factor = T)
selected.brfss$race<-relevel(selected.brfss$race, ref= 'White')
selected.brfss$bmi<- car::recode(selected.brfss$bmi, recodes = "1='Underweight'; 2='Normal'; 3='Overweight'; 4='Obese'; else='NA'", as.factor = T)
selected.brfss$bmi<- relevel(selected.brfss$bmi, ref = 'Normal')
brfss<- read_xpt("LLCP2021XPT.zip")
brfss<- dplyr::rename(brfss,
lungcancer= "CNCRTYP1",
state= "_STATE",
educa= "_EDUCAG",
income= "INCOME3",
sex= "SEXVAR",
race= "_RACE",
age= "_AGE_G",
bmi= "_BMI5CAT",
smoke.status= "_SMOKER3",
asthma= "ASTHNOW")
selected.brfss<- (dplyr::select(brfss, lungcancer, state, educa, income, sex, race, age, bmi, smoke.status, asthma))
#Lung Cancer
selected.brfss$lungcancer<- car::recode(selected.brfss$lungcancer, recodes = "1='0'; 2='0'; 3='0'; 4='0'; 5='0'; 5='0'; 6='0'; 7='0'; 8='0'; 9='0'; 10='0'; 11='0'; 12='0'; 13='0'; 14='0'; 15='0'; 16='0'; 17='0'; 18='0'; 19='0'; 20='0'; 21='0'; 22='0'; 23='0'; 24='1'; 25='0'; 26='0'; 27='0'; 28='0'; 29='0'; 30='0'; 77:99=NA")
#Asthma Status
selected.brfss$asthma<- car::recode(selected.brfss$asthma, recodes = "1='1'; 2='0'; else=NA", as.factor = T)
#Smoking Status
selected.brfss$smoke.status<- car::recode(selected.brfss$smoke.status, recodes = "1:2='current smoker'; 3='former smoker'; 4='never smoker'; 9='NA'", as.factor = T)
selected.brfss$smoke.status<- relevel(selected.brfss$smoke.status, ref = 'never smoker')
#Sex
selected.brfss$sex<- car::recode(selected.brfss$sex, recodes= "1='Male'; 2='Female'", as.factor =T)
selected.brfss$sex<- relevel(selected.brfss$sex, ref= 'Male')
#Education: No High School, High School, Some/Higher Education
selected.brfss$educa<- car::recode(selected.brfss$educa, recodes= "1='NoHighSchool'; 2='HighSchool'; 3:4='Some/HigherEduca'; 9= 'NA'", as.factor=T)
selected.brfss$educa<-relevel(selected.brfss$educa, ref= 'Some/HigherEduca')
#Race
selected.brfss$race<- car::recode(selected.brfss$race, recodes = "1='White'; 2='Black'; 3= 'AmericanIndian/AlaskanNative'; 4='Asian'; 5='NativeHawaiian/PacificIslander'; 6='Other'; 7='Multiracial'; 8='Hispanic'; 9='NA'", as.factor = T)
selected.brfss$race<-relevel(selected.brfss$race, ref= 'White')
#BMI
selected.brfss$bmi<- car::recode(selected.brfss$bmi, recodes = "1='Underweight'; 2='Normal'; 3='Overweight'; 4='Obese'; else='NA'", as.factor = T)
selected.brfss$bmi<- relevel(selected.brfss$bmi, ref = 'Normal')
#Income <$25k, $25-75k, >$75k
selected.brfss$income<- car::recode(selected.brfss$income, recodes = "1:4='Low'; 5:7='Middle'; 8:11='High'; else=NA")
selected.brfss$income<- relevel(selected.brfss$income, ref='High')
selected.brfss$lungcancer<- car::recode(selected.brfss$lungcancer, recodes = "1='0'; 2='0'; 3='0'; 4='0'; 5='0'; 5='0'; 6='0'; 7='0'; 8='0'; 9='0'; 10='0'; 11='0'; 12='0'; 13='0'; 14='0'; 15='0'; 16='0'; 17='0'; 18='0'; 19='0'; 20='0'; 21='0'; 22='0'; 23='0'; 24='1'; 25='0'; 26='0'; 27='0'; 28='0'; 29='0'; 30='0'; 77:99='NA'")
selected.brfss$lungcancer<- car::recode(selected.brfss$lungcancer, recodes = "1='0'; 2='0'; 3='0'; 4='0'; 5='0'; 5='0'; 6='0'; 7='0'; 8='0'; 9='0'; 10='0'; 11='0'; 12='0'; 13='0'; 14='0'; 15='0'; 16='0'; 17='0'; 18='0'; 19='0'; 20='0'; 21='0'; 22='0'; 23='0'; 24='1'; 25='0'; 26='0'; 27='0'; 28='0'; 29='0'; 30='0'; else='NA'")
selected.brfss$income<- car::recode(selected.brfss$income, recodes = "1:4='Low'; 5:7='Middle'; 8:11='High'; else=NA", as.factor = T)
selected.brfss$income<- car::recode(selected.brfss$income, recodes = "1:4='Low'; 5:7='Middle'; 8:11='High'; else=NA")
View(brfss)
View(selected.brfss)
selected.brfss$income<- car::recode(selected.brfss$income, recodes = "1:4='Low'; 5:7='Middle'; 8:11='High'; else=NA")
selected.brfss$income<- car::recode(selected.brfss$income, recodes = "1:4='Low'; 5:7='Middle'; 8:11='High'; 77:99='NA'")
View(selected.brfss)
selected.brfss$income<- car::recode(selected.brfss$income, recodes = "1:4='Low'; 5:7='Middle'; 8:11='High'; else='NA'", as.factor = T)
selected.brfss$income<- relevel(selected.brfss$income, ref = 'High')
selected.brfss$income<- car::recode(selected.brfss$income, recodes = "1:4='Low'; 5:7='Middle'; 8:11='High'; else='NA'", as.factor = T)
selected.brfss$income<- relevel(selected.brfss$income, ref = 'High')
table1(~sex + race + age + bmi | lungcancer, data=selected.brfss)
selected.brfss$age<- car::recode(selected.brfss$age, recodes= "1:2= '18-34'; 3:4='35-54'; 5='55-64'; 6='>65'", as.factor=T)
selected.brfss$age<-relevel(selected.brfss$age, ref='18-34')
table1(~sex + race + age + bmi | lungcancer, data=selected.brfss)
brfss<- read_xpt("LLCP2021XPT.zip")
brfss<- dplyr::rename(brfss,
lungcancer= "CNCRTYP1",
state= "_STATE",
educa= "_EDUCAG",
income= "INCOME3",
sex= "SEXVAR",
race= "_RACE",
age= "_AGE_G",
bmi= "_BMI5CAT",
smoke.status= "_SMOKER3",
asthma= "ASTHNOW")
selected.brfss<- (dplyr::select(brfss, lungcancer, state, educa, income, sex, race, age, bmi, smoke.status, asthma))
selected.brfss$lungcancer<- car::recode(selected.brfss$lungcancer, recodes = "1='0'; 2='0'; 3='0'; 4='0'; 5='0'; 5='0'; 6='0'; 7='0'; 8='0'; 9='0'; 10='0'; 11='0'; 12='0'; 13='0'; 14='0'; 15='0'; 16='0'; 17='0'; 18='0'; 19='0'; 20='0'; 21='0'; 22='0'; 23='0'; 24='1'; 25='0'; 26='0'; 27='0'; 28='0'; 29='0'; 30='0'; else='NA'")
selected.brfss$lungcancer<- car::recode(selected.brfss$lungcancer, recodes = "1='0'; 2='0'; 3='0'; 4='0'; 5='0'; 5='0'; 6='0'; 7='0'; 8='0'; 9='0'; 10='0'; 11='0'; 12='0'; 13='0'; 14='0'; 15='0'; 16='0'; 17='0'; 18='0'; 19='0'; 20='0'; 21='0'; 22='0'; 23='0'; 24='1'; 25='0'; 26='0'; 27='0'; 28='0'; 29='0'; 30='0'; else='NA'", as.factor = T)
selected.brfss$lungcancer<- relevel(selected.brfss$lungcancer, ref= '0')
selected.brfss$asthma<- car::recode(selected.brfss$asthma, recodes = "1='1'; 2='0'; else=NA", as.factor = T)
selected.brfss$smoke.status<- car::recode(selected.brfss$smoke.status, recodes = "1:2='current smoker'; 3='former smoker'; 4='never smoker'; 9='NA'", as.factor = T)
selected.brfss$smoke.status<- relevel(selected.brfss$smoke.status, ref = 'never smoker')
selected.brfss$sex<- car::recode(selected.brfss$sex, recodes= "1='Male'; 2='Female'", as.factor =T)
selected.brfss$sex<- relevel(selected.brfss$sex, ref= 'Male')
selected.brfss$educa<- car::recode(selected.brfss$educa, recodes= "1='NoHighSchool'; 2='HighSchool'; 3:4='Some/HigherEduca'; 9= 'NA'", as.factor=T)
selected.brfss$educa<-relevel(selected.brfss$educa, ref= 'Some/HigherEduca')
selected.brfss$race<- car::recode(selected.brfss$race, recodes = "1='White'; 2='Black'; 3= 'AmericanIndian/AlaskanNative'; 4='Asian'; 5='NativeHawaiian/PacificIslander'; 6='Other'; 7='Multiracial'; 8='Hispanic'; 9='NA'", as.factor = T)
selected.brfss$race<-relevel(selected.brfss$race, ref= 'White')
selected.brfss$age<- car::recode(selected.brfss$age, recodes= "1:2= '18-34'; 3:4='35-54'; 5='55-64'; 6='>65'", as.factor=T)
selected.brfss$age<-relevel(selected.brfss$age, ref='18-34')
selected.brfss$bmi<- car::recode(selected.brfss$bmi, recodes = "1='Underweight'; 2='Normal'; 3='Overweight'; 4='Obese'; else='NA'", as.factor = T)
selected.brfss$bmi<- relevel(selected.brfss$bmi, ref = 'Normal')
selected.brfss$income<- car::recode(selected.brfss$income, recodes = "1:4='Low'; 5:7='Middle'; 8:11='High'; else='NA'", as.factor = T)
selected.brfss$income<- relevel(selected.brfss$income, ref = 'High')
table1(~sex + race + age + bmi +income| lungcancer, data=selected.brfss)
selected.brfss$asthma<-relevel(selected.brfss$asthma, ref= '0')
table1(~sex + race + age + bmi +income| lungcancer, data=selected.brfss)
selected.brfss$lungcancer<- car::recode(selected.brfss$lungcancer, recodes = "1='0'; 2='0'; 3='0'; 4='0'; 5='0'; 5='0'; 6='0'; 7='0'; 8='0'; 9='0'; 10='0'; 11='0'; 12='0'; 13='0'; 14='0'; 15='0'; 16='0'; 17='0'; 18='0'; 19='0'; 20='0'; 21='0'; 22='0'; 23='0'; 24='1'; 25='0'; 26='0'; 27='0'; 28='0'; 29='0'; 30='0'; 77:99='NA'", as.factor = T)
selected.brfss$lungcancer<- relevel(selected.brfss$lungcancer, ref= '0')
table1(~sex + race + age + bmi +income| lungcancer, data=selected.brfss)
table1(~sex + race + age + bmi | lungcancer, data=selected.brfss)
table1(~educa + income | lungcancer, data = selected.brfss)
table1(~smoke.status + asthma | lungcancer, data = selected.brfss)
library(dplyr)
library(haven)
library(feather)
library(ggplot2)
library(table1)
library(survey)
library(car)
smart<-read_xpt("MMSA2021_XPT.zip")
smart.variables <- dplyr::rename(smart, county= "MMSANAME",
county.weight= "_MMSAWT",
state= "STATERE1",
education = "_EDUCAG",
sex = "_SEX",
income = "_INCOMG1",
race = "_MRACE1",
age= "_AGE_G",
age65= "_AGE65YR",
BMI= "_BMI5CAT",
SMOKERSTATUS = "_SMOKER3",
FORMERSMOKER = "_RFSMOK3",
ASTHMANOW= "_CASTHM1",
ASTHMA= "_ASTHMS1")
selected.smart<- (dplyr::select(smart.variables, county, county.weight, state, education, sex, income, race, age, age65, BMI, SMOKERSTATUS, FORMERSMOKER, ASTHMANOW, ASTHMA))
install.packages("gtsummary")
library(gtsummary)
selected.smart %>% gtsummary::tbl_summary()
View(selected.smart)
selected.smart$sex<- car::recode(selected.smart$sex, recodes = "1='Male'; 2='Female'")
selected.smart$sex<- relevel(selected.smart$sex, ref= 'Male')
selected.smart$race<- car::recode(selected.smart$race, recodes = "1= 'White'; 2= 'Black'; 3= 'AmericanIndian/AlaskanNative'; 4= 'Asian'; 5= 'NativeHawaiian/PacificIslander'; 6= 'Other'; 7= 'Multiracial'; 77:99= 'NA'")
selected.smart %>% gtsummary::tbl_summary()
selected.smart %>%
dplyr::select(-c(age65,FORMERSMOKER)) %>%
gtsummary::tbl_summary(by= ASTHMANOW) %>%
gtsummary::add_p()
selected.smart$ASTHMANOW<- car::recode(selected.smart$ASTHMANOW, recodes = "1= 'No Asthma'; 2='Asthma'; 9='NA'")
selected.smart$ASTHMANOW<- relevel(selected.smart$ASTHMANOW, ref='No Asthma')
selected.smart %>%
dplyr::select(-c(age65,FORMERSMOKER, state)) %>%
gtsummary::tbl_summary(by= ASTHMANOW) %>%
gtsummary::add_p()
selected.smart %>%
dplyr::select(-c(age65,FORMERSMOKER, state, county, county.weight)) %>%
gtsummary::tbl_summary(by= ASTHMANOW) %>%
gtsummary::add_p()
selected.smart$income<- car::recode(selected.smart$income, recodes= "1:3= '<$35k'; 4= '$35-50k'; 5= '$50-100k'; 6:7= '>100k'; 9= 'NA'")
selected.smart$income<- relevel(selected.smart$income, ref= '>100k')
selected.smart$SMOKERSTATUS<- car::recode(selected.smart$SMOKERSTATUS, recodes= "1:2='Current Smoker'; 3= 'Former Smoker'; 4= 'Never Smoker'; 9= 'NA'")
selected.smart$education<- car::recode(selected.smart$education, recodes = "1= 'No HighSchool'; 2= 'HighSchool'; 3:4= 'Some/HigherEduca'; 9= 'NA'")
selected.smart$age65<- car::recode(selected.smart$age65, recodes = "1= '1'; 2= '2'; 3= 'NA'")
selected.smart$age65<- relevel(selected.smart$age65, ref= '1')
selected.smart %>%
dplyr::select(-c(age65,FORMERSMOKER, state, county, county.weight)) %>%
gtsummary::tbl_summary(by= ASTHMANOW) %>%
gtsummary::add_p()
selected.smart %>%
dplyr::select(c(age65,FORMERSMOKER, SMOKERSTATUS, county)) %>%
gtsummary::tbl_summary(by= ASTHMANOW) %>%
gtsummary::add_p()
selected.smart %>%
dplyr::select(age65,FORMERSMOKER, SMOKERSTATUS, county)
gtsummary::tbl_summary(by= ASTHMANOW) %>%
gtsummary::add_p()
ggplot(data=selected.smart, aes(x=ASMTHMANOW))+
geom_bar()
ggplot(data=selected.smart, aes(x=ASTHMANOW))+
geom_bar()
ggplot(data=selected.smart, aes(x=ASTHMANOW))+
geom_bar()
ggplot(data=selected.smart, aes(x=ASTHMA))+
geom_bar()
ggplot(data=selected.smart, aes(x=ASTHMANOW))+
geom_bar()
ggplot(data=selected.smart, aes(x=ASTHMA))+
geom_bar()
ggplot(data = selected.smart, aes(x= race, fill= ASTHMANOW))+
geom_bar(position = "dodge")
ggplot(data = selected.smart, aes(x= race, fill= ASTHMANOW))+
geom_bar(position = "dodge", "X axis"= 'slant' )
ggplot(data = selected.smart, aes(x= race, fill= ASTHMANOW))+
geom_bar(position = "dodge") + scale_x_discrete(labels= "slant")
ggplot(data=selected.smart, aes(x=ASTHMANOW))+
geom_bar()
ggplot(data=selected.smart, aes(x=ASTHMA))+
geom_bar()
table1(~sex + race + education + income | ASTHMANOW, data= selected.smart)
selected.smart$BMI<- car::recode(selected.smart$BMI, recodes= "1= 'Underweight'; 2='Normal'; 3:4='Overweight/Obese'; else= 'NA'")
table1(~factor(age65) + SMOKERSTATUS + BMI | ASTHMANOW, data= selected.smart)
install.packages("MatchIt")
library(MatchIt)
pvalue<- function(x, ...) {
y<- unlist(x)
g<- factor(rep(1:length(x), times=sapply(x, length)))
if (is.numeric(y)) {
p<- t.test(y~g)$p.value
} else {
p<- chisq.test(table(y,g))$p.value
}
c("", sub("<", "&lt;", format.pval(p, digits=3, eps=0.001)))
}
table1(~sex + race + education + income | ASTHMANOW,
data= selected.smart, overall =F, extra.col = list(`P-value`=pvalue))
table1(~factor(age65) + SMOKERSTATUS + BMI | ASTHMANOW,
data= selected.smart, overall =F, extra.col = list(`P-value`=pvalue))
View(pvalue)
